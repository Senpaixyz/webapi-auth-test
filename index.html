<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fingerprint Biometrics</title>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            var registerBtn = document.getElementById('registerFingerprintBtn');
            var scanBtn = document.getElementById('scanFingerprintBtn');

            if (registerBtn) {
                registerBtn.addEventListener('click', function () {
                    registerFingerprint();
                });
            }

            if (scanBtn) {
                scanBtn.addEventListener('click', function () {
                    scanFingerprint();
                });
            }
        });

        function registerFingerprint() {
            navigator.credentials.create({
                publicKey: {
                    challenge: new Uint8Array([ // must be generated by the server
                        0x8c, 0x82, 0x99, 0xc1, 0x1b, 0x59, 0x4b, 0xa0, 0x92, 0xac, 0x5c, 0xd7, 0xc3, 0x72, 0xc7, 0xb4,
                        0x02, 0x4d, 0xd6, 0x4d, 0x0f, 0xbf, 0x4b, 0xc3, 0xae, 0xa2, 0x55, 0x80, 0x63, 0x2c, 0xd2, 0x25
                    ]).buffer,
                    rp: {
                        name: "Example Corp"
                    },
                    user: {
                        id: new Uint8Array([ // must be unique for each user
                            0x8c, 0x82, 0x99, 0xc1, 0x1b, 0x59, 0x4b, 0xa0, 0x92, 0xac, 0x5c, 0xd7, 0xc3, 0x72, 0xc7, 0xb4
                        ]),
                        name: "user@example.com",
                        displayName: "Example User"
                    },
                    pubKeyCredParams: [{
                        type: "public-key",
                        alg: -7
                    }],
                    authenticatorSelection: {
                        authenticatorAttachment: "platform",
                        userVerification: "required"
                    },
                    timeout: 60000,
                    attestation: "direct"
                }
            }).then(function (credential) {
                var fingerprintId = credential.id;
                saveFingerprint(fingerprintId);
            }).catch(function (error) {
                console.error(error);
            });
        }

        function scanFingerprint() {
            navigator.credentials.get({
                publicKey: {
                    challenge: new Uint8Array([ // must be generated by the server
                        0x8c, 0x82, 0x99, 0xc1, 0x1b, 0x59, 0x4b, 0xa0, 0x92, 0xac, 0x5c, 0xd7, 0xc3, 0x72, 0xc7, 0xb4,
                        0x02, 0x4d, 0xd6, 0x4d, 0x0f, 0xbf, 0x4b, 0xc3, 0xae, 0xa2, 0x55, 0x80, 0x63, 0x2c, 0xd2, 0x25
                    ]).buffer,
                    allowCredentials: [{
                        id: new Uint8Array([ // should be the user's credential ID
                            0x8c, 0x82, 0x99, 0xc1, 0x1b, 0x59, 0x4b, 0xa0, 0x92, 0xac, 0x5c, 0xd7, 0xc3, 0x72, 0xc7, 0xb4
                        ]),
                        type: "public-key"
                    }],
                    userVerification: "required",
                    timeout: 60000
                }
            }).then(function (credential) {
                var fingerprintId = credential.id;
                var machineId = 'your_machine_ip';  // Get the machine IP as needed
                validateFingerprint(fingerprintId, machineId);
            }).catch(function (error) {
                console.error(error);
            });
        }

        function saveFingerprint(fingerprintId) {
            // Simulate saving the fingerprint ID (e.g., send to a server)
            console.log('Fingerprint ID saved:', fingerprintId);
            alert('Fingerprint registered successfully');
        }

        function validateFingerprint(fingerprintId, machineId) {
            // Simulate validating the fingerprint ID (e.g., send to a server)
            console.log('Fingerprint ID validated:', fingerprintId, 'Machine ID:', machineId);
            alert('Fingerprint matched for employee');
        }
    </script>
</head>

<body>
    <h1>Fingerprint Biometrics</h1>

    <div>
        <h2>Register Fingerprint</h2>
        <button id="registerFingerprintBtn">Register Fingerprint</button>
    </div>

    <div>
        <h2>Scan Fingerprint</h2>
        <button id="scanFingerprintBtn">Scan Fingerprint</button>
    </div>
</body>

</html>